<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>CodeMirror</title>
  <!-- CodeMirror -->
  <link rel="stylesheet" href="lib/codemirror.css">
  <link rel="stylesheet" href="https://codemirror.net/theme/eclipse.css">
  <script src="https://codemirror.net/lib/codemirror.js"></script>
  <script src="mode/javascript/javascript.js"></script>
</head>

<body><br>
<textarea id="code" name="code" style="height: 180px; width:700px;">
<h1>sss</h1>
</textarea><br>

<button id="ID_B0">AFFICHER</button><br>
<iframe id="iframe"></iframe>

<script type="text/javascript">
    var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        mode: 'application/javascript',
        theme: "eclipse",
        lineNumbers: true,
        gutters: ["CodeMirror-linenumbers"]
    });

    document.getElementById("ID_B0").onclick = function(event) {
        var html = document.getElementById("code").value = editor.getValue();
        var iframe = document.getElementById("iframe");
        iframe.src = 'data:text/html;charset=utf-8,' + encodeURI(html);
        document.body.appendChild(iframe);
        console.log('iframe.contentWindow =', iframe.contentWindow);
    };

</script>
</body>
</html>
